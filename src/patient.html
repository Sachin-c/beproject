<!DOCTYPE html>
<html>
    <head>
           
            <meta name="viewport" content="width=device-width, initial-scale=1">
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
            <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
            <!-- <script src="node_modules/web3/dist/web3.min.js" type="text/javascript"></script>
            <script src="node_modules/truffle-contract/dist/truffle-contract.js" type="text/javascript"></script> -->
            <script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js@1.0.0-beta.36/dist/web3.min.js"></script>
            <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
            <script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>
        <title></title>
        <meta charset="utf-8" />
        
    </head>
    <body><h2 id="print"></h2>
      <form id="form1">
            <p class="text-danger" id="error"></p>
                    <div class="form-group">
                      <label for="Name">Name</label>
                      <input type="text" class="form-control" id="name" placeholder="Enter Name">
                    </div>
                    <div class="form-group">
                      <label for="Age">Age</label>
                      <input type="number" class="form-control" id="age" placeholder="Age">
                    </div>
                    <div class="form-group">
                        <label for="Gender">Gender</label>
                        <input type="text" class="form-control" id="gender" placeholder="Gender">
                    </div>
                    <div class="form-group">
                        <label for="Blood Group">Blood Group</label>
                        <input type="text" class="form-control" id="bg" placeholder="Blood Group">
                    </div>
        </form>
                    
                    <button id="button" onclick="setvalue()" class="btn btn-primary">Submit</button> 
                 
                  
                  <script type="text/javascript">

function setvalue() {
                        try {
                          
                            var abi=[{
                                "constant": false,
                                "inputs": [
                                  {
                                    "internalType": "string",
                                    "name": "_name",
                                    "type": "string"
                                  },
                                  {
                                    "internalType": "uint256",
                                    "name": "_age",
                                    "type": "uint256"
                                  },
                                  {
                                    "internalType": "string",
                                    "name": "_gender",
                                    "type": "string"
                                  },
                                  {
                                    "internalType": "string",
                                    "name": "_bg",
                                    "type": "string"
                                  }
                                ],
                                "name": "set",
                                "outputs": [],
                                "payable": false,
                                "stateMutability": "nonpayable",
                                "type": "function"
                              },
                              {
                                "constant": true,
                                "inputs": [],
                                "name": "get",
                                "outputs": [
                                  {
                                    "internalType": "string",
                                    "name": "",
                                    "type": "string"
                                  },
                                  {
                                    "internalType": "uint256",
                                    "name": "",
                                    "type": "uint256"
                                  },
                                  {
                                    "internalType": "string",
                                    "name": "",
                                    "type": "string"
                                  },
                                  {
                                    "internalType": "string",
                                    "name": "",
                                    "type": "string"
                                  }
                                ],
                                "payable": false,
                                "stateMutability": "view",
                                "type": "function"
                              },
                              {
                                "constant": true,
                                "inputs": [],
                                "name": "patientCount",
                                "outputs": [
                                  {
                                    "internalType": "uint256",
                                    "name": "",
                                    "type": "uint256"
                                  }
                                ],
                                "payable": false,
                                "stateMutability": "view",
                                "type": "function"
                              }
                            ];
                            var address='0xBb64c1467f4F2d470046E5d580ac835045D9fc44';

                            if (typeof web3 !== undefined) 
                            {
                              web3 = new Web3(web3.currentProvider);
                            } 
                            else
                            {
                              web3 = new Web3(new Web3.providers.HttpProvider('http://localhost:7545'));
                          }
                        // var contractaddress = '';
                         console.log( web3.eth.defaultAccount)
                        var myFunction = new web3.eth.Contract(abi,address);
                        // console.log(web3.eth.getAccounts())

                        
                        async function getCurrentAccount(){
                          var currentAccounts = await web3.eth.getAccounts();
                          console.log(currentAccounts);
                          return currentAccounts[0];
                      }
                      a=currentAccounts;
                        // console.log(web3.eth.getAccounts().then( function (result) { return result[0] }));
                        myFunction.methods.set(document.getElementById("form1").elements[0].value,document.getElementById("form1").elements[1].value,document.getElementById("form1").elements[2].value,document.getElementById("form1").elements[3].value).send({from:a ,gas: 3000000}, function (error, result) {
                        if (!error) {
                        console.log(result);
                        } else {
                        console.log(error);
                        }
                        })
                        } catch (err) {
                        document.getElementById("print").innerHTML = err;
                        }
                        }
                  var abi=[
                            {
                              "constant": false,
                              "inputs": [
                                {
                                  "internalType": "string",
                                  "name": "_name",
                                  "type": "string"
                                },
                                {
                                  "internalType": "uint256",
                                  "name": "_age",
                                  "type": "uint256"
                                },
                                {
                                  "internalType": "string",
                                  "name": "_gender",
                                  "type": "string"
                                },
                                {
                                  "internalType": "string",
                                  "name": "_bg",
                                  "type": "string"
                                }
                              ],
                              "name": "set",
                              "outputs": [],
                              "payable": false,
                              "stateMutability": "nonpayable",
                              "type": "function"
                            },
                            {
                              "constant": true,
                              "inputs": [],
                              "name": "get",
                              "outputs": [
                                {
                                  "internalType": "string",
                                  "name": "",
                                  "type": "string"
                                },
                                {
                                  "internalType": "uint256",
                                  "name": "",
                                  "type": "uint256"
                                },
                                {
                                  "internalType": "string",
                                  "name": "",
                                  "type": "string"
                                },
                                {
                                  "internalType": "string",
                                  "name": "",
                                  "type": "string"
                                }
                              ],
                              "payable": false,
                              "stateMutability": "view",
                              "type": "function"
                            },
                            {
                              "constant": true,
                              "inputs": [],
                              "name": "patientCount",
                              "outputs": [
                                {
                                  "internalType": "uint256",
                                  "name": "",
                                  "type": "uint256"
                                }
                              ],
                              "payable": false,
                              "stateMutability": "view",
                              "type": "function"
                            }
                          ]
;                 var address='0xBb64c1467f4F2d470046E5d580ac835045D9fc44';
                      if (typeof web3 !== undefined) 
                      {
                        web3 = new Web3(web3.currentProvider);
                      } 
                      else
                      {
                        web3 = new Web3(new Web3.providers.HttpProvider('http://localhost:7545'));
                      }                      
                      var Courses = new web3.eth.Contract(abi,address);
                      // console.log(Courses.methods);
                      Courses.methods.get().call().then(function(number){
                      // console.log(number)
                      var result=number;
                      document.getElementById("print").innerHTML=result[0]+"("+result[1]+" years old) is "+result[2]+"with blood group "+result[3];
                     });
                    </script>
    </body>
</html>